.. _README:

======
README
======

The Mindboggle package enables a user to automate anatomical labeling,
feature extraction, and shape analysis of human brain MR image data.

Help
====
- `Online documentation <http://mindboggle.info/documentation.html>`_
- `Installation instructions <INSTALL.html>`_
- Help on the command line::

    >>> python mindboggler.py --help

- `Contributor list <THANKS.html>`_

License
=======
Except where noted, all Mindboggle software is under the `Apache v2.0`_
license, and documentation is under a `Creative Commons Attribution 3.0 License`_.

Inputs
======
Mindboggle currently uses output from FreeSurfer v5.3 and the newest ANTs
software packages.
FreeSurfer provides labeled cortical surface meshes and subcortical volumes
as well as white and gray matter segmentation.
ANTS provides brain extraction, segmentation, and registration-based labeling.

To prepare inputs for Mindboggle, run FreeSurfer_ on each T1-weighted IMAGE file and set the SUBJECT name
(replace capitalized text below when typing in a terminal window)::

    $ recon-all -all -s SUBJECT -i IMAGE

To run the antsCorticalThickness.sh script in ANTs on the same IMAGE file,
download the `OASIS-30 template <http://mindboggle.info/data/templates/atropos/OASIS-30_Atropos_template.tar.gz>`_,
set an output PREFIX, and set "-k 1" to save registration transforms (backslashes denote line returns)::

    $ antsCorticalThickness.sh -d 3 \
      -a IMAGE \
      -e OASIS-30_Atropos_template/T_template0.nii.gz \
      -m OASIS-30_Atropos_template/T_template0ProbabilityMask.nii.gz \
      -p OASIS-30_Atropos_template/Priors2/priors%d.nii.gz \
      -f OASIS-30_Atropos_template/T_template0ExtractionMask.nii.gz \
      -k 1 \
      -o PREFIX \
      -w 0.25 \
      -n 3

Examples
========
Terminal command for processing (on 4 processors) multiple subjects with only FreeSurfer data::

    >>> python mindboggler.py SUBJECT1 SUBJECT2 SUBJECT3 -n 4

Example using ANTs data (with PREFIX for files in folder ~/ants_data)::

    >>> python mindboggler.py SUBJECT1 SUBJECT2 SUBJECT3 --ants_data ~/ants_output PREFIX

Example using most of the currently available options within Mindboggle::

    >>> python mindboggler.py SUBJECT1 SUBJECT2 SUBJECT3 --ants_data ~/ants_output PREFIX
    ...                       --sulci --fundi --vertices --spectra 10 --thickness
    ...                       --visual hier

Outputs
=======
By default, all atlas and template data retrieved via the Internet
as well as Nipype workflow files are saved in $HOME/mindboggle_cache/,
and final outputs are saved in $HOME/mindboggled/
(where $HOME is the home directory).
Nifti_ image volumes (.nii.gz) store anatomical labels as numbers
listed in the mindboggle/LABELS.py file and `online <http://mindboggle.info/data/mindboggle101/protocol.txt>`_, and
all left and right cortical surface (.vtk) vertices are number-labeled
by anatomical label, feature, or shape measure. Shape measure statistics
are stored in tables (.csv).

+-+---------------+----------------------------------------------+--------------+
| |  **Folder**   | **Contents**                                 | **Format**   |
+-+---------------+----------------------------------------------+--------------+
| |   features/   |  surface features: folds, sulci, fundi       | .vtk         |
+-+---------------+----------------------------------------------+--------------+
| |   labels/     |  number-labeled surfaces and volumes         | .vtk, .nii.gz|
+-+---------------+----------------------------------------------+--------------+
| |   shapes/     |  surfaces with shape measures (per vertex)   | .vtk         |
+-+---------------+----------------------------------------------+--------------+
| |   tables/     |  tables of shape measures per label/feature  | .csv         |
+-+---------------+----------------------------------------------+--------------+

**mindboggled**/

    **features**/[left,right]_surface/SUBJECT/  *# features extracted from cortical surface meshes*

            **folds**.vtk  *# depth-based cortical surface folds (invaginations)*

            **fundus_per_fold**.vtk  *# curves running along depths of folds*

            **fundus_per_sulcus**.vtk  *# fundus curves segmented by sulcus labels*

            **sulci**.vtk  *# folds segmented into sulci using label pairs*

    **labels**/[left,right]_surface/SUBJECT/  *# FreeSurfer-based surface and volume labels*

            **FreeSurfer_cortex_labels**.vtk  *# DKT40 classifier surface labels*

            **FreeSurfer_cortex_volume_labels**.vtk  *# surfaces relabeled to correspond to volume labels (left=1000+; right=2000+)

            **FreeSurfer_filled_labels**.nii.gz  *# cortex and noncortex separately filled with atlas labels*

    **labels**/SUBJECT/atlas/  *# ANTs-based volume labels*

            **ANTs_registered_labels**.nii.gz  *# atlas labels registered to subject*

            [left,right]_ **ANTs_filled_labels**.nii.gz  *# cortex and noncortex separately filled with atlas labels*

    **labels**/**cortex_and_noncortex**.nii.gz  *# brain segmented into cortex=2 and noncortex=3*

    **shapes**/[left,right]_surface/SUBJECT/  *# per-vertex surface shape measures*

            **area**.vtk

            **FreeSurfer_convexity**.vtk  *# FreeSurfer's [lh,rh].sulc files*

            **FreeSurfer_thickness**.vtk  *# FreeSurfer's [lh,rh].thickness files*

            **geodesic_depth**.vtk

            **mean_curvature**.vtk

            **travel_depth**.vtk

    **tables**/[left,right]_surface/SUBJECT/  *# tables with per-feature surface shape statistics*

            **fundus_shapes**.csv

            **label_shapes**.csv

            **sulcus_shapes**.csv

            **thicknesses_of_FreeSurfer_filled_cortex_labels**.csv

            **vertices**.csv  *# (exception: per-vertex shape table)*

            **volumes_of_FreeSurfer_filled_labels**.csv

    **tables**/SUBJECT/atlas/  *# tables with per-label volumes*

            [left,right]_ **thicknesses_of_ANTs_filled_cortex_labels**.csv

            [left,right]_ **volumes_of_ANTs_filled_labels**.csv

The shape tables above contain a subset of the following measures:

    - Surface area
    - Travel depth
    - Geodesic depth
    - Mean curvature
    - Convexity (FreeSurfer)
    - Thickness (FreeSurfer)
    - Laplace-Beltrami spectra (per feature)
    - Zernike moments (per feature)
    - Volume and thickness
