.. _INSTALL2:

========================
Installation from source
========================

We highly recommend installing Mindboggle as a virtual machine
(see `INSTALL <http://mindboggle.info/users/INSTALL.html>`_), but for those
who wish to install from source code, we provide some instructions below.

Scientific Python environment
-----------------------------
Easily-installed Python distributions are available such as Anaconda_,
Canopy_, and PythonXY_ that include components necessary to run Mindboggle:
Python_ 2.7, NumPy_, SciPy_, Networkx_.  These distributions also include
packages that benefit the user, such as IPython_ (parallel processing) and
Sphinx_ (generating documentation).

Your system must have basic compilation software (cmake_ and a C++ compiler such as gcc_),
pip for installing Python libraries, and the `Visualization Toolkit`_
(after installing the Anaconda Python distribution)::

    conda install cmake
    conda install pip
    conda install vtk

Nibabel_ (medical image read/write library) and Nipype_ (software pipeline framework) not included above::

    pip install nibabel
    # Or: git clone https://github.com/nipy/nibabel.git
    #     cd nibabel; python setup.py install
    pip install nipype

.. pip install git+git://github.com/nipy/nipype.git # latest development source
 
Non-Python software packages
----------------------------
Use FreeSurfer_ and ANTS_ to process T1-weighted MRI data for use by
Mindboggle.  See `README <http://mindboggle.info/users/README.html>`_ for
instructions on running ``recon-all`` in FreeSurfer and
``antsCorticalThickness.sh`` in ANTs.

FreeSurfer_ (`download <http://surfer.nmr.mgh.harvard.edu>`_)
provides labeled cortical surfaces and non/cortical volumes.
(Note: Mindboggle expects the FreeSurfer SUBJECTS_DIR environment
variable to be set.)

ANTs_ (`download <http://brianavants.wordpress.com/2012/04/13/updated-ants-compile-instructions-april-12-2012/>`_)
optionally provides tissue segmentation, affine registration to standard
space, and nonlinear registration for whole-brain labeling, to improve and
extend Mindboggle results.
(Note: After installing ANTS, be sure to copy the files in ANTs/Scripts/
to the antsbin/bin/ directory, and set the ANTSPATH environment variable.)

Download Mindboggle
-------------------
To check out the latest development version using git_::

    git clone git://github.com/binarybottle/mindboggle.git

Install Mindboggle
------------------
Step 1: Install Mindboggle Python software
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Change into the ``mindboggle`` directory and install mindboggle
(depending on permissions you may need to use ``sudo``)::

    python setup.py install

Step 2: Compile Mindboggle C++ code
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In the mindboggle_tools/bin directory, run cmake (or ccmake) and make::

    cd mindboggle/mindboggle_tools/bin/
    cmake ..
    make

Step 3: Set environment variables
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
For your system to recognize the C++ code we just compiled, include
the following lines in your system's equivalent of a .bash_profile file,
replacing <path to mindboggle> and <path to anaconda>::

    MINDBOGGLE_TOOLS=<path to mindboggle>/mindboggle_tools/bin/
    export MINDBOGGLE_TOOLS
    export PATH=$PATH:$MINDBOGGLE_TOOLS
    #export DYLD_LIBRARY_PATH=<path to anaconda>/lib/vtk-5.10:${DYLD_LIBRARY_PATH}
